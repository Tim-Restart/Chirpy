package auth

import (
	"Bcrypt"
	"log"
	"errors"
)

// Function to hash a given password and return the hash
func HashPassword(password string) (string, error) {
	hashedPassword, err := GenerateFromPassword(password)
	if err != nil {
		log.Print("Error hasing password")
		return nil, err
	}

	return hashedPassword

}

// Function to check inputed password against users recorded hash

func CheckPasswordHash(hash, password string) error {
	// Hash the entered password first
	entered_password, err := GenerateFromPassword(password)
	if err != nil {
		log.Print("Error checking password")
		return err
	}
	// Compare the current hash with the entered password hash
	if entered_password != hash {
		log.Print("Incorrect Password")
		return errors.New("Incorrect Password")
	}

	// Returns nil if passwords match!
	return nil
}
